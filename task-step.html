<!DOCTYPE html>
<html>
  <head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-60508041-1"></script>

<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-60508041-1');
</script>

<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=775" />
<title>task step - Concourse CI</title>
<link rel="stylesheet" type="text/css" href="css/normalize.css" />
<link rel="stylesheet" type="text/css" href="css/pipeline.css" />
<link rel="stylesheet" type="text/css" href="css/iosevka.css" />
<link rel="stylesheet" type="text/css" href="css/booklit.css" />
<link rel="stylesheet" type="text/css" href="css/prism.css" />
<link rel="shortcut icon" type="image/x-icon" href="favicon.ico" />
<link href="https://fonts.googleapis.com/css?family=Barlow:400,400i,700|Roboto+Slab:300,400,700" rel="stylesheet" />
<script src="js/search.js"></script>
<script async type="text/javascript" src="js/prism.js"></script>
  </head>
  <body>
    <div class="top-logo">
  <a href="/"><img src="images/logo-white.svg" />Concourse</a>
</div>

<nav class="top-nav">
  
  <a class="top-link active" href="docs.html">Docs</a>
  
  <a class="top-link" href="examples.html">Examples</a>
  
  <a class="top-link" href="project.html">Project</a>
  
  <a class="top-link" href="https://blog.concourse-ci.org">blog</a>
  <a class="top-link" href="https://discuss.concourse-ci.org">discuss</a>
  <a class="top-link" href="https://resource-types.concourse-ci.org">Resource Types</a>
</nav>

<div class="top-search">
  <div id="search"></div>
</div>

<div class="top-banner">
  ✨ The 2020 Concourse CI Community Survey is now live! ✨ <a href="https://airtable.com/shr4tyAb5ApbX3VV1">Click here to learn more and share your experience</a>.
</div>

<script type="text/javascript">
  var app = Elm.Main.init({
    node: document.getElementById('search')
  });

  app.ports.emitSearchTerm.subscribe(function(term) {
    gtag('event', 'search', {search_term: term});
  });
</script>

    <div class="page-nav">
      







  
  
  
  
  

  
  <div class="context">
    <nav>
      <div class="top">
        
        <span class="section-number">1</span>
        
        
  <a href="docs.html"  class="active">Docs</a>

      </div>

      <div class="children">
        <table>
        
          <tr>
            
              <td class="number-cell" align="right">1.1&nbsp;</td>
            
            <td class="title-cell">
  <a href="install.html" >Install</a>
</td>
          </tr>
        
          <tr>
            
              <td class="number-cell" align="right">1.2&nbsp;</td>
            
            <td class="title-cell">
  <a href="auth.html" >Auth &amp; Teams</a>
</td>
          </tr>
        
          <tr>
            
              <td class="number-cell" align="right">1.3&nbsp;</td>
            
            <td class="title-cell">
  <a href="fly.html" >The <code>fly</code> CLI</a>
</td>
          </tr>
        
          <tr>
            
              <td class="number-cell" align="right">1.4&nbsp;</td>
            
            <td class="title-cell">
  <a href="config-basics.html" >Config Basics</a>
</td>
          </tr>
        
          <tr>
            
              <td class="number-cell" align="right">1.5&nbsp;</td>
            
            <td class="title-cell">
  <a href="pipelines.html" >Pipelines</a>
</td>
          </tr>
        
          <tr>
            
              <td class="number-cell" align="right">1.6&nbsp;</td>
            
            <td class="title-cell">
  <a href="resources.html" >Resources</a>
</td>
          </tr>
        
          <tr>
            
              <td class="number-cell" align="right">1.7&nbsp;</td>
            
            <td class="title-cell">
  <a href="resource-types.html" >Resource Types</a>
</td>
          </tr>
        
          <tr>
            
              <td class="number-cell" align="right">1.8&nbsp;</td>
            
            <td class="title-cell">
  <a href="jobs.html"  class="active">Jobs</a>
</td>
          </tr>
        
          <tr>
            
              <td class="number-cell" align="right">1.9&nbsp;</td>
            
            <td class="title-cell">
  <a href="tasks.html" >Tasks</a>
</td>
          </tr>
        
          <tr>
            
              <td class="number-cell" align="right">1.10&nbsp;</td>
            
            <td class="title-cell">
  <a href="builds.html" >Builds</a>
</td>
          </tr>
        
          <tr>
            
              <td class="number-cell" align="right">1.11&nbsp;</td>
            
            <td class="title-cell">
  <a href="operation.html" >Operation</a>
</td>
          </tr>
        
          <tr>
            
              <td class="number-cell" align="right">1.12&nbsp;</td>
            
            <td class="title-cell">
  <a href="observation.html" >Observation</a>
</td>
          </tr>
        
        </table>
      </div>
    </nav>
  </div>
  

  

  
  <div class="context">
    <nav>
      <div class="top">
        
        <span class="section-number">1.8</span>
        
        
  <a href="jobs.html"  class="active">Jobs</a>

      </div>

      <div class="children">
        <table>
        
          <tr>
            
              <td class="number-cell" align="right">1.8.1&nbsp;</td>
            
            <td class="title-cell">
  <a href="steps.html"  class="active">Steps</a>
</td>
          </tr>
        
          <tr>
            
              <td class="number-cell" align="right">1.8.2&nbsp;</td>
            
            <td class="title-cell">
  <a href="managing-jobs.html" >Managing Jobs</a>
</td>
          </tr>
        
        </table>
      </div>
    </nav>
  </div>
  

  

  
  <div class="context">
    <nav>
      <div class="top">
        
        <span class="section-number">1.8.1</span>
        
        
  <a href="steps.html"  class="active">Steps</a>

      </div>

      <div class="children">
        <table>
        
          <tr>
            
              <td class="number-cell" align="right">1.8.1.1&nbsp;</td>
            
            <td class="title-cell">
  <a href="get-step.html" ><code>get</code> step</a>
</td>
          </tr>
        
          <tr>
            
              <td class="number-cell" align="right">1.8.1.2&nbsp;</td>
            
            <td class="title-cell">
  <a href="put-step.html" ><code>put</code> step</a>
</td>
          </tr>
        
          <tr>
            
              <td class="number-cell" align="right">1.8.1.3&nbsp;</td>
            
            <td class="title-cell">
  <a href="task-step.html"  class="self"><code>task</code> step</a>
</td>
          </tr>
        
          <tr>
            
              <td class="number-cell" align="right">1.8.1.4&nbsp;</td>
            
            <td class="title-cell">
  <a href="set-pipeline-step.html" ><code>set_pipeline</code> step</a>
</td>
          </tr>
        
          <tr>
            
              <td class="number-cell" align="right">1.8.1.5&nbsp;</td>
            
            <td class="title-cell">
  <a href="aggregate-step.html" ><code>aggregate</code> step</a>
</td>
          </tr>
        
          <tr>
            
              <td class="number-cell" align="right">1.8.1.6&nbsp;</td>
            
            <td class="title-cell">
  <a href="in-parallel-step.html" ><code>in_parallel</code> step</a>
</td>
          </tr>
        
          <tr>
            
              <td class="number-cell" align="right">1.8.1.7&nbsp;</td>
            
            <td class="title-cell">
  <a href="do-step.html" ><code>do</code> step</a>
</td>
          </tr>
        
          <tr>
            
              <td class="number-cell" align="right">1.8.1.8&nbsp;</td>
            
            <td class="title-cell">
  <a href="try-step.html" ><code>try</code> step</a>
</td>
          </tr>
        
          <tr>
            
              <td class="number-cell" align="right">1.8.1.9&nbsp;</td>
            
            <td class="title-cell">
  <a href="on-success-step-hook.html" ><code>on_success</code> step hook</a>
</td>
          </tr>
        
          <tr>
            
              <td class="number-cell" align="right">1.8.1.10&nbsp;</td>
            
            <td class="title-cell">
  <a href="on-failure-step-hook.html" ><code>on_failure</code> step hook</a>
</td>
          </tr>
        
          <tr>
            
              <td class="number-cell" align="right">1.8.1.11&nbsp;</td>
            
            <td class="title-cell">
  <a href="on-abort-step-hook.html" ><code>on_abort</code> step hook</a>
</td>
          </tr>
        
          <tr>
            
              <td class="number-cell" align="right">1.8.1.12&nbsp;</td>
            
            <td class="title-cell">
  <a href="on-error-step-hook.html" ><code>on_error</code> step hook</a>
</td>
          </tr>
        
          <tr>
            
              <td class="number-cell" align="right">1.8.1.13&nbsp;</td>
            
            <td class="title-cell">
  <a href="ensure-step-hook.html" ><code>ensure</code> step hook</a>
</td>
          </tr>
        
          <tr>
            
              <td class="number-cell" align="right">1.8.1.14&nbsp;</td>
            
            <td class="title-cell">
  <a href="tags-step-modifier.html" ><code>tags</code> step modifier</a>
</td>
          </tr>
        
          <tr>
            
              <td class="number-cell" align="right">1.8.1.15&nbsp;</td>
            
            <td class="title-cell">
  <a href="timeout-step-modifier.html" ><code>timeout</code> step modifier</a>
</td>
          </tr>
        
          <tr>
            
              <td class="number-cell" align="right">1.8.1.16&nbsp;</td>
            
            <td class="title-cell">
  <a href="attempts-step-modifier.html" ><code>attempts</code> step modifier</a>
</td>
          </tr>
        
        </table>
      </div>
    </nav>
  </div>
  








<div class="context">
  <div class="Top">
    On this page:
  </div>

  <div class="children anchors">
    <table>
      
      <tr>
        <td colspan="2" class="title-cell"><a href="task-step.html#task"><strong><code>task</code></strong></a></td>
      </tr>
      
      <tr>
        <td colspan="2" class="title-cell"><a href="task-step.html#task-step-config"><strong><code>config</code></strong></a></td>
      </tr>
      
      <tr>
        <td colspan="2" class="title-cell"><a href="task-step.html#task-step-file"><strong><code>file</code></strong></a></td>
      </tr>
      
      <tr>
        <td colspan="2" class="title-cell"><a href="task-step.html#task-step-privileged"><strong><code>privileged</code></strong></a></td>
      </tr>
      
      <tr>
        <td colspan="2" class="title-cell"><a href="task-step.html#task-step-vars"><strong><code>vars</code></strong></a></td>
      </tr>
      
      <tr>
        <td colspan="2" class="title-cell"><a href="task-step.html#task-step-params"><strong><code>params</code></strong></a></td>
      </tr>
      
      <tr>
        <td colspan="2" class="title-cell"><a href="task-step.html#task-step-image"><strong><code>image</code></strong></a></td>
      </tr>
      
      <tr>
        <td colspan="2" class="title-cell"><a href="task-step.html#input_mapping"><strong><code>input_mapping</code></strong></a></td>
      </tr>
      
      <tr>
        <td colspan="2" class="title-cell"><a href="task-step.html#output_mapping"><strong><code>output_mapping</code></strong></a></td>
      </tr>
      

      
  
    
  

    </table>
  </div>
</div>

    </div>

    <div class="page-aside">
      <div class="page-partial">
        <div class="content">
  <h2>Examples</h2>

  <div class="example">
  <h3>Inputs &amp; Outputs</h3>

  <p>The following plan pulls down a repo, makes a commit to it, and pushes the commit to another repo (the task must have an output called <code>repo-with-commit</code>):</p><pre><code class="language-yaml">plan:
- get: my-repo
- task: commit
  file: my-repo/commit.yml
- put: other-repo
  params:
    repository: repo-with-commit</code></pre>
</div><div class="example">
  <h3>Build Matrix with <code>in_parallel</code></h3>

  <p>The following plan fetches a single repository and executes multiple tasks, using the <a href="in-parallel-step.html"><code>in_parallel</code></a> step, in a build matrix style configuration:</p><pre><code class="language-yaml">plan:
- get: my-repo
- in_parallel:
  - task: go-1.3
    file: my-repo/go-1.3.yml
  - task: go-1.4
    file: my-repo/ci/go-1.4.yml</code></pre><p>Only if both tasks succeed will the build go green. See also <a href="in-parallel-step.html"><code>in_parallel</code> step</a>.</p>
</div>
</div>
      </div>
      </div>

    <div class="page-content">
      <div class="section" id="section_task-step">
  
  <h1 class="section-header"><a class="anchor" name="task-step" href="#task-step"></a><span class="section-number">1.8.1.3 </span><code>task</code> step</h1>
  

  <p>Executes a <a href="tasks.html">Task</a>, either from a file fetched via the preceding steps, or with inlined configuration.</p><p>If any task in the build plan fails, the build will complete with failure. By default, any subsequent steps will not be performed. You can perform additional steps after failure by adding a <a href="on-failure-step-hook.html"><code>on_failure</code></a> or <a href="ensure-step-hook.html"><code>ensure</code></a> step hook.</p><p>When a task completes, the files in its declared outputs will be made avaliable to subsequent steps. This allows those subsequent steps to process the result of a task.</p><div class="definition">
  <div class="definition-thumb">
    <a name="task"></a>
    <pre><a href="task-step.html#task"><strong>task</strong></a>: string</pre>
  </div>

  <div class="definition-content">
    <p><em>Required.</em> A freeform name for the task that&#39;s being executed. Common examples would be <code>unit</code> or <code>integration</code>.</p>
  </div>
</div><div class="definition">
  <div class="definition-thumb">
    <a name="task-step-config"></a>
    <pre><a href="task-step.html#task-step-config"><strong>config</strong></a>: object</pre>
  </div>

  <div class="definition-content">
    <p><em>Required.</em> The <a href="tasks.html">task config</a> to execute. An alternative to <a href="task-step.html#task-step-file"><strong><code>file</code></strong></a>.</p>
  </div>
</div><div class="definition">
  <div class="definition-thumb">
    <a name="task-step-file"></a>
    <pre><a href="task-step.html#task-step-file"><strong>file</strong></a>: string</pre>
  </div>

  <div class="definition-content">
    <p><em>Required.</em> A dynamic alternative to <a href="task-step.html#task-step-config"><strong><code>config</code></strong></a>.</p><p><code>file</code> points at a <code>.yml</code> file containing the <a href="tasks.html">task config</a>, which allows this to be tracked with your resources.</p><p>The first segment in the path should refer to another source from the plan, and the rest of the path is relative to that source.</p><p>For example, if in your plan you have the following <a href="get-step.html"><code>get</code></a> step:</p><pre><code class="language-yaml">- get: something</code></pre><p>And the <code>something</code> resource provided a <code>unit.yml</code> file, you would set <code>file: something/unit.yml</code>.</p><p>The content of the config file may contain template <code>((vars))</code>, which will be filled in using <a href="task-step.html#task-step-vars"><strong><code>vars</code></strong></a> or a configured <a href="creds.html">credential manager</a>.</p>
  </div>
</div><div class="definition">
  <div class="definition-thumb">
    <a name="task-step-privileged"></a>
    <pre><a href="task-step.html#task-step-privileged"><strong>privileged</strong></a>: boolean</pre>
  </div>

  <div class="definition-content">
    <p><em>Optional. Default <code>false</code>.</em> If set to <code>true</code>, the task will run with full capabilities, as determined by the Garden backend the task runs on. For Linux-based backends it typically determines whether or not the container will run in a separate user namespace, and whether the <code>root</code> user is &#34;actual&#34; <code>root</code> (if set to <code>true</code>) or a user namespaced <code>root</code> (if set to <code>false</code>, the default).</p><p>This is a gaping security hole; use wisely and only if necessary. This is not part of the task configuration to prevent privilege escalation via pull requests.</p>
  </div>
</div><div class="definition">
  <div class="definition-thumb">
    <a name="task-step-vars"></a>
    <pre><a href="task-step.html#task-step-vars"><strong>vars</strong></a>: object</pre>
  </div>

  <div class="definition-content">
    <p><em>Optional.</em> A map of template variables to pass to an external task. Not to be confused with <a href="task-step.html#task-step-params"><strong><code>params</code></strong></a>, which provides <em>environment variables</em> to the task.</p><p>This is to be used with external tasks defined in <a href="task-step.html#task-step-file"><strong><code>file</code></strong></a>.</p><p>For example, a var may be statically passed like so:</p><pre><code class="language-yaml">plan:
- get: my-repo
- task: integration
  file: my-repo/ci/task.yml
  vars:
    text: &#34;Hello World!&#34;</code></pre><p>This is often used in combination with <a href="setting-pipelines.html#pipeline-vars"><code>((vars))</code></a> in the pipeline (note the replacement of the string literal with the <code>((text))</code> pipeline var):</p><pre><code class="language-yaml">plan:
- get: my-repo
- task: integration
  file: my-repo/ci/task.yml
  vars:
    text: ((text))</code></pre><p>When run with the following <code>task.yml</code>:</p><pre><code class="language-yaml">---
platform: linux

image_resource:
  type: docker-image
  source:
    repository: my.local.registry:8080/my/image
    username: ((myuser))
    password: ((mypass))

run:
  path: echo
  args: [&#34;((text))&#34;]</code></pre><p>...this will resolve <code>&#34;((text))&#34;</code> to <code>&#34;Hello World!&#34;</code>, while <code>((myuser))</code> and <code>((mypass))</code>  will be resolved in runtime via a <a href="creds.html">credential manager</a>, if it has been configured.</p>
  </div>
</div><div class="definition">
  <div class="definition-thumb">
    <a name="task-step-params"></a>
    <pre><a href="task-step.html#task-step-params"><strong>params</strong></a>: object</pre>
  </div>

  <div class="definition-content">
    <p><em>Optional.</em> A map of task environment variable parameters to set, overriding those configured in the task&#39;s <code>config</code> or <code>file</code>.</p><p>The difference between <a href="task-step.html#task-step-params"><strong><code>params</code></strong></a> and <a href="task-step.html#task-step-vars"><strong><code>vars</code></strong></a> is that <a href="task-step.html#task-step-vars"><strong><code>vars</code></strong></a> allows you to interpolate any template variable in an external task, while <a href="task-step.html#task-step-params"><strong><code>params</code></strong></a> can be used to overwrite task parameters (i.e. env variables) specifically. Also, <a href="task-step.html#task-step-params"><strong><code>params</code></strong></a> can have default values declared in the task.</p><p>For example:</p><pre><code class="language-yaml">plan:
- get: my-repo
- task: integration
  file: my-repo/ci/integration.yml
  params:
    REMOTE_SERVER: 10.20.30.40:8080
    USERNAME: my-user
    PASSWORD: my-pass</code></pre><p>This is often used in combination with <a href="setting-pipelines.html#pipeline-vars"><code>((vars))</code></a> in the pipeline.</p><p>For example:</p><pre><code class="language-yaml">plan:
- get: my-repo
- task: integration
  file: my-repo/ci/integration.yml
  params:
    REMOTE_SERVER: 10.20.30.40:8080
    USERNAME: ((integration-username))
    PASSWORD: ((integration-password))</code></pre><p>Looking into the <code>task.yml</code>, a common pattern is to list the param in the task definition with no value. This indicates that you expect the pipeline to provide the value.</p><p>For example, in the <code>task.yml</code>:</p><pre><code class="language-yaml">params:
  FOO: fizzbuzz
  BAR:</code></pre><p>And in the <code>pipeline.yml</code>:</p><pre><code class="language-yaml">params:
  BAR: qux</code></pre><p>If the pipeline used this <code>task.yml</code> but did not set <code>BAR</code>, the value of <code>$BAR</code> would be set to the empty string in the task container.</p>
  </div>
</div><div class="definition">
  <div class="definition-thumb">
    <a name="task-step-image"></a>
    <pre><a href="task-step.html#task-step-image"><strong>image</strong></a>: string</pre>
  </div>

  <div class="definition-content">
    <p><em>Optional.</em> Names an artifact source within the plan containing an image to use for the task. This overrides any <a href="tasks.html#image_resource"><strong><code>image_resource</code></strong></a> configuration present in the task configuration.</p><p>This is very useful when part of your pipeline involves building an image, possibly with dependencies pre-baked. You can then propagate that image through the rest of your pipeline, guaranteeing that the correct version (and thus a consistent set of dependencies) is used throughout your pipeline.</p><p>For example, here&#39;s a pipeline building an image in one job and propagating it to the next:</p><pre><code class="language-yaml">resources:
- name: my-project
  type: git
  source: {uri: https://github.com/my-user/my-project}

- name: my-task-image
  type: docker-image
  source: {repository: my-user/my-repo}

jobs:
- name: build-task-image
  plan:
  - get: my-project
  - put: my-task-image
    params: {build: my-project/ci/images/my-task}

- name: use-task-image
  plan:
  - get: my-task-image
    passed: [build-task-image]
  - get: my-project
    passed: [build-task-image]
  - task: use-task-image
    image: my-task-image
    file: my-project/ci/tasks/my-task.yml</code></pre><p>This can also be used in the simpler case of explicitly keeping track of dependent images, in which case you just wouldn&#39;t have a job building it (<code>build-task-image</code> in the above example).</p>
  </div>
</div><div class="definition">
  <div class="definition-thumb">
    <a name="input_mapping"></a>
    <pre><a href="task-step.html#input_mapping"><strong>input_mapping</strong></a>: object</pre>
  </div>

  <div class="definition-content">
    <p><em>Optional.</em> A map from task input names to concrete names in the build plan. This allows a task with generic input names to be used multiple times in the same plan, mapping its inputs to specific resources within the plan.</p><p>For example:</p><pre><code class="language-yaml">plan:
- get: diego-release
- get: cf-release
- get: ci-scripts
- task: audit-diego-release
  file: ci-scripts/audit-release.yml
  input_mapping: {release-repo: diego-release}
- task: audit-cf-release
  file: ci-scripts/audit-release.yml
  input_mapping: {release-repo: cf-release}</code></pre>
  </div>
</div><div class="definition">
  <div class="definition-thumb">
    <a name="output_mapping"></a>
    <pre><a href="task-step.html#output_mapping"><strong>output_mapping</strong></a>: object</pre>
  </div>

  <div class="definition-content">
    <p><em>Optional.</em> A map from task output names to concrete names to register in the build plan. This allows a task with generic output names to be used multiple times in the same plan.</p><p>This is often used together with <a href="task-step.html#input_mapping"><strong><code>input_mapping</code></strong></a>. For example:</p><pre><code class="language-yaml">plan:
- get: diego-release
- get: cf-release
- get: ci-scripts
- task: create-diego-release
  file: ci-scripts/create-release.yml
  input_mapping: {release-repo: diego-release}
  output_mapping: {release-tarball: diego-release-tarball}
- task: create-cf-release
  file: ci-scripts/create-release.yml
  input_mapping: {release-repo: cf-release}
  output_mapping: {release-tarball: cf-release-tarball}</code></pre>
  </div>
</div>

  
    
  
</div>

      <nav class="prev-next">
      
        <div class="prev">
          prev:

          
          <span class="section-number">1.8.1.2</span>
          

          <a href="put-step.html"><code>put</code> step</a>
        </div>
      

      
        <div class="next">
          next:

          
          <span class="section-number">1.8.1.4</span>
          

          <a href="set-pipeline-step.html"><code>set_pipeline</code> step</a>
        </div>
      
      </nav>
    </div>

    <ul class="improve-docs">
      <li><img src="images/icons/github-box.svg" /> <a href="https://github.com/concourse/docs">help improve this site</a></li>
      <li><img src="images/booklit.svg" /> powered by <a href="https://vito.github.io/booklit">Booklit</a></li>
    </ul>
  </body>
</html>